<?php
/**
 * Byblio
 * partial view helper, dialogue box, account locked
 * @copyright 2013 Byblio.com
 * @author: Paul A. Oliver
 *
 */
	// email in use
	$email = $this->email;
	// next time to log in
	$loginNextTimeStr = $this->loginNextTimeStr;
	
	// title
	$titleStr = $this->translate('Is that you?');

?>

<!--  html -->
<div style="{display:none;}"> <!-- wrap in hidden div to stop fouc -->
	<div id="dialogue-message" class="dialogue-message" title="<?php echo $titleStr; ?>">
		<div class="message">
			<p>
				<span class="alert">
				<?php echo $this->translate('The account for') ." " .$email ." " .$this->translate('has been locked because there has been too many unsuccessful attempts to log in.');?>
				</span>
			</p>
			<p>
				<?php echo $this->translate('You can either wait until') ." " .$loginNextTimeStr ." " .$this->translate('to try again, or follow the link below to reset your password and unlock your account.');?>
			</p>
			
			<div class="links">
				<div class="link_goto">
	   				<a href="<?php echo $this->url('useraccount-forgotpassword');?>"><?php echo $this->translate('Click here to go to the reset password page');?></a>
	   			</div>
				
	   		</div>
		
		</div>
	</div>
</div>

<!-- script to activate -->
<script>

	// css to hide close button, set title colour, set link colour
	var closeStr = ".ui-dialog-titlebar-close{display: none;}";
	var titleStr = ".ui-dialog-title{color:#F00 !important;}"; // must be '!important'
	var alertStr = ".ui-dialog .alert{color:#F00;}";
	var allCSSStr = "<style>" +closeStr +titleStr +alertStr +"</style>"
	// write csss
	document.write(allCSSStr);

	
	// open dialogue box
	// NOTE: important to blur the links and buttons on open (else they will be highlighted)
	
	$(function(){
	    $("#dialogue-message").dialog({
	        modal: true,
	        buttons: {
		        Ok: function() {
		          $(this).dialog( "close" );
		        }
	      	},
	     	draggable: false,
	     	resizable: false,
	     	open: function(event, ui){ // blur
	     		$('.ui-dialog :button').blur();
	     		$('.ui-dialog a').blur();
	        },
	        position: {my: 'center center', at: 'center center-50', of: window},
	        dialogClass: 'signup', // page class
	    });
	});


  
</script>